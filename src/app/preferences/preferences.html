<div class="min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-800 relative overflow-hidden">
  <!-- Animated background elements -->
  <div class="absolute inset-0 overflow-hidden">
    <div class="absolute -top-40 -right-40 w-80 h-80 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-30 animate-blob"></div>
    <div class="absolute -bottom-40 -left-40 w-80 h-80 bg-pink-500 rounded-full mix-blend-multiply filter blur-xl opacity-30 animate-blob animation-delay-2000"></div>
    <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-80 h-80 bg-indigo-500 rounded-full mix-blend-multiply filter blur-xl opacity-30 animate-blob animation-delay-4000"></div>
  </div>

  <!-- Navigation Bar -->
  <nav class="relative z-10 bg-white/10 backdrop-blur-lg border-b border-white/20">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <div class="flex items-center space-x-3">
          <button (click)="goBack()" class="text-white hover:text-purple-200 transition-colors">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
            </svg>
          </button>
          <h1 class="text-white text-xl font-bold">My Preferences</h1>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="relative z-10 max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Skeleton Loading -->
    @if (isLoading()) {
      <div class="space-y-8 animate-pulse">
        @for (i of [1,2,3]; track i) {
          <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20">
            <div class="h-8 bg-white/20 rounded w-1/3 mb-4"></div>
            <div class="grid grid-cols-5 md:grid-cols-10 gap-3">
              @for (j of [1,2,3,4,5,6,7,8,9,10]; track j) {
                <div class="w-12 h-12 bg-white/20 rounded-xl"></div>
              }
            </div>
          </div>
        }
      </div>
    }

    <!-- Success Message -->
    @if (successMessage()) {
      <div class="mb-6 bg-green-500/20 backdrop-blur-lg rounded-2xl p-4 border border-green-500/30">
        <div class="flex items-center space-x-3">
          <svg class="w-6 h-6 text-green-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          <p class="text-green-100">{{ successMessage() }}</p>
        </div>
      </div>
    }

    <!-- Error Message -->
    @if (errorMessage()) {
      <div class="mb-6 bg-red-500/20 backdrop-blur-lg rounded-2xl p-4 border border-red-500/30">
        <div class="flex items-center space-x-3">
          <svg class="w-6 h-6 text-red-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <p class="text-red-100">{{ errorMessage() }}</p>
        </div>
      </div>
    }

    <form [formGroup]="preferencesForm" (ngSubmit)="savePreferences()" class="space-y-8" [class.hidden]="isLoading()">
      <!-- Favorite Color -->
      <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20">
        <h2 class="text-2xl font-bold text-white mb-4">Favorite Color</h2>
        <div class="grid grid-cols-5 md:grid-cols-10 gap-3">
          @for (color of colors; track color) {
            <button
              type="button"
              (click)="preferencesForm.patchValue({favoriteColors: color})"
              [class]="preferencesForm.value.favoriteColors === color
                ? 'w-12 h-12 rounded-xl shadow-lg transform scale-110 ring-4 ring-white transition-all'
                : 'w-12 h-12 rounded-xl shadow-md hover:scale-105 transition-all'"
              [style.background-color]="color"
              [title]="color"
            ></button>
          }
        </div>
        <p class="text-purple-200 text-sm mt-3">Selected: <span class="text-white font-semibold">{{ preferencesForm.value.favoriteColors }}</span></p>
      </div>

      <!-- Preferred Style -->
      <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20">
        <h2 class="text-2xl font-bold text-white mb-4">Preferred Style</h2>
        <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
          @for (style of styles; track style.name) {
            <button
              type="button"
              (click)="preferencesForm.patchValue({preferredStyles: style.name})"
              [class]="preferencesForm.value.preferredStyles === style.name
                ? 'p-4 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl text-white font-medium shadow-lg transform scale-105 transition-all'
                : 'p-4 bg-white/10 rounded-xl text-purple-200 font-medium hover:bg-white/20 transition-all'"
            >
              <div class="text-3xl mb-2">{{ style.icon }}</div>
              <div>{{ style.name }}</div>
            </button>
          }
        </div>
      </div>

      <!-- Shoe Size -->
      <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20">
        <h2 class="text-2xl font-bold text-white mb-4">Shoe Size</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-purple-100 text-sm font-medium mb-2">US Size</label>
            <input
              type="number"
              formControlName="shoeSize"
              placeholder="e.g., 9"
              class="w-full px-4 py-3 bg-white/10 border border-purple-300/30 rounded-xl text-white placeholder-purple-300 focus:outline-none focus:ring-2 focus:ring-purple-400 focus:border-transparent transition duration-200 backdrop-blur-sm"
            />
          </div>
          <div class="flex items-end">
            <p class="text-purple-200 text-sm">
              Enter your US shoe size to get better recommendations for footwear.
            </p>
          </div>
        </div>
      </div>

      <!-- Body Type -->
      <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20">
        <h2 class="text-2xl font-bold text-white mb-4">Body Type</h2>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
          @for (bodyType of bodyTypes; track bodyType) {
            <button
              type="button"
              (click)="preferencesForm.patchValue({bodyType: bodyType})"
              [class]="preferencesForm.value.bodyType === bodyType
                ? 'px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl font-medium shadow-lg transform scale-105'
                : 'px-6 py-3 bg-white/10 text-purple-200 rounded-xl font-medium hover:bg-white/20 transition-all'"
            >
              {{ bodyType }}
            </button>
          }
        </div>
        <p class="text-purple-200 text-sm mt-3">
          This helps us provide better outfit recommendations tailored to your body type.
        </p>
      </div>

      <!-- Save Button -->
      <div class="flex justify-end space-x-4">
        <button
          type="button"
          (click)="goBack()"
          class="px-6 py-3 bg-white/10 hover:bg-white/20 text-white rounded-xl font-medium transition-all"
        >
          Cancel
        </button>
        <button
          type="submit"
          [disabled]="preferencesForm.invalid || isSaving()"
          class="px-8 py-3 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 disabled:opacity-50 disabled:cursor-not-allowed text-white font-semibold rounded-xl shadow-lg transform hover:scale-105 transition-all duration-200"
        >
          @if (isSaving()) {
            <div class="flex items-center">
              <svg class="animate-spin h-5 w-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
              Saving...
            </div>
          } @else {
            Save Preferences
          }
        </button>
      </div>
    </form>

    <!-- Tips Section -->
    <div class="mt-8 bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20">
      <div class="flex items-start space-x-4">
        <svg class="w-6 h-6 text-purple-300 mt-1 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <div>
          <h3 class="text-white font-semibold mb-2">Why we ask for these preferences?</h3>
          <p class="text-purple-200 text-sm">
            Your preferences help our system generate better outfit recommendations tailored specifically to you.
            We use this information to match clothing items that suit your style, body type, and personal taste.
            All your data is kept private and secure.
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
